<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->

<div>
  @for(node of nodes; track node.id){
    <div>
      <!-- Применение класса через [class] -->
      <div [class.deleted]="node.is_deleted">
        <!-- Если есть дети, показываем стрелку, кликом переключаем состояние -->
        @if(node.children && node.children.length > 0){
          <span
            (click)="toggle(node)"
            class="toggle-arrow">
            {{ expanded[node.id] ? '▲' : '▼' }}
          </span>
        }
        <!-- Если детей нет, используется отступ -->
        @else {
          <span class="spacer"></span>
        }

        {{ node.id }} - {{ node.title }}
      </div>

      <!-- Рекурсивно снова вызываем наш компонент если есть дети -->
      @if(node.children && node.children.length > 0 && expanded[node.id]){
        <div class="child-nodes">
          <lib-tree-feature-tree [nodes]="node.children"></lib-tree-feature-tree>
        </div>
      }
    </div>
  }
</div>
